axis.ticks = element_blank(),
legend.position = "right",
legend.title = element_blank(),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle = element_blank(),
plot.title = element_blank())
states_shp %>%
left_join(same_sex_marriage, by = c("NAME" = "Region")) %>%
ggplot() +
geom_sf(aes(fill = 100*Favor)) +
scale_fill_gradient(name = "Global Acceptance Index",
low = "#999247", high = "#8C4799") +
xlim(-125, -65) +
ylim(25, 50) +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.position = "right",
legend.title = element_blank(),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle = element_text(color = "#999247", hjust = 0.5, size = 15),
plot.title = element_text(color = "#8C4799", hjust = 0.5, size = 20)) +
labs(title = "State Populations in Favor of Same-Sex Marriage",
subtitle = "30 Day Map Challenge, Day 26: Choropleth",
caption = "Data Source: Public Religion Research Institute (2017)",
x = "", y = "")
states_shp %>%
left_join(same_sex_marriage, by = c("NAME" = "Region")) %>%
ggplot() +
geom_sf(aes(fill = 100*Favor)) +
scale_fill_gradient(name = "Global Acceptance Index",
low = "#999247", high = "#8C4799") +
xlim(-125, -65) +
ylim(25, 50) +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.position = "right",
legend.title = element_blank(),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle = element_text(color = "#999247", hjust = 0.5, size = 15),
plot.title = element_text(color = "#8C4799", hjust = 0.5, size = 20)) +
labs(title = "State Populations in Favor of Same-Sex Marriage",
subtitle = "30 Day Map Challenge, Day 26: Choropleth",
caption = "Data Source: Public Religion Research Institute (2017)",
x = "", y = "")
knitr::opts_chunk$set(echo = TRUE)
library("leaflet")
library("tidyverse")
# https://geohack.toolforge.org/geohack.php?pagename=University_of_California,_Merced&params=37.366_N_120.4235_W_region:US-CA_type:edu
UCM_lat <- 37.366
UCM_long <- -120.4235
data_df <- data.frame(lat = UCM_lat, long = UCM_long)
Bobcat_icon <- makeIcon(
iconUrl = "Bobcat.png",
iconWidth = 32, iconHeight = 32
)
leaflet() %>%
setView(lng = UCM_long, lat = UCM_lat, zoom = 11) %>%
#https://leaflet-extras.github.io/leaflet-providers/preview/
addProviderTiles("Esri.NatGeoWorldMap") %>%
addCircles(data = data_df,
radius = 1000,
color = "#002856",
fillColor = "#002856",
popup = paste0(
"<strong>UC Merced</strong>","<br>",
"<strong>Established: </strong>", "2005", "<br>",
"<strong>Lecturers: </strong>", "190"
))
# addMarkers(lng = UCM_long, lat = UCM_lat, icon = Bobcat_icon)
knitr::opts_chunk$set(echo = TRUE)
library("sf") #handle shape files
library("tmap") #display static maps
# load shape file
merced_road_shp <- st_read("Merced_County_Road_Centerlines/Road_Centerlines.shp")
# print map
tm_shape(merced_road_shp) +
tm_lines("gray50") +
tm_layout(main.title = "30 Day Map Challenge (Day 2: Lines)")
library("terra")
ca_rain_tif_1 <- terra::rast("CA_annual_rainfall_1961_1990.tif")
ca_rain_tif_2 <- terra::rast("CA_annual_rainfall_1971_2000.tif")
ca_rain_tif_2 <- terra::aggregate(ca_rain_tif_2, fact = 5)
ca_rain_tif_1 <- terra::rast("CA_annual_rainfall_1961_1990.tif")
ca_rain_tif_2 <- terra::rast("CA_annual_rainfall_1971_2000.tif")
ca_rain_tif_2 <- terra::aggregate(ca_rain_tif_2, fact = 5)
ca_rain_df_1 <- as.data.frame(ca_rain_tif_1, xy = TRUE)
ca_rain_df_2 <- as.data.frame(ca_rain_tif_2, xy = TRUE)
View(ca_rain_df_1)
ca_rain_tif_1 <- terra::rast("CA_annual_rainfall_1961_1990.tif")
ca_rain_tif_2 <- terra::rast("CA_annual_rainfall_1971_2000.tif")
ca_rain_tif_2 <- terra::aggregate(ca_rain_tif_2, fact = 2)
ca_rain_df_1 <- as.data.frame(ca_rain_tif_1, xy = TRUE)
ca_rain_df_2 <- as.data.frame(ca_rain_tif_2, xy = TRUE)
ca_rain_tif_1 <- terra::rast("CA_annual_rainfall_1961_1990.tif")
ca_rain_tif_2 <- terra::rast("CA_annual_rainfall_1971_2000.tif")
# ca_rain_tif_2 <- terra::aggregate(ca_rain_tif_2, fact = 2)
ca_rain_df_1 <- as.data.frame(ca_rain_tif_1, xy = TRUE)
ca_rain_df_2 <- as.data.frame(ca_rain_tif_2, xy = TRUE)
View(ca_rain_df_2)
combined_df <- ca_rain_df_1 |>
left_join(ca_rain_df_2, by = c("x", "y"))
#| message: false
#| warning: false
library("tidyverse")
knitr::opts_chunk$set(echo = TRUE)
combined_df <- ca_rain_df_1 |>
left_join(ca_rain_df_2, by = c("x", "y"))
View(combined_df)
# https://geodata.lib.berkeley.edu/catalog/stanford-wq585xv0760
ca_rain_tif_1 <- terra::rast("CA_annual_rainfall_1961_1990.tif")
# https://geodata.lib.berkeley.edu/catalog/stanford-fs379qr8881
ca_rain_tif_2 <- terra::rast("CA_annual_rainfall_1971_2000.tif")
# ca_rain_tif_2 <- terra::aggregate(ca_rain_tif_2, fact = 2)
ca_rain_df_1 <- as.data.frame(ca_rain_tif_1, xy = TRUE)
ca_rain_df_2 <- as.data.frame(ca_rain_tif_2, xy = TRUE)
colnames(ca_rain_df_1) <- c("x", "y", "rain")
colnames(ca_rain_df_1) <- c("x", "y", "rain")
round_any = function(x, accuracy, f=round){f(x/ accuracy) * accuracy}
ca_rain_df_1_rounded <- ca_rain_df_2 %>%
mutate(round_x = round_any(x, 0.2),
round_y = round_any(y, 0.2)) %>%
group_by(round_x, round_y) %>%
mutate(avg_rain = mean(rain, na.rm = TRUE)) %>%
ungroup() %>%
select(round_x, round_y, avg_rain)
colnames(ca_rain_df_2) <- c("x", "y", "rain")
round_any = function(x, accuracy, f=round){f(x/ accuracy) * accuracy}
ca_rain_df_1_rounded <- ca_rain_df_2 %>%
mutate(round_x = round_any(x, 0.2),
round_y = round_any(y, 0.2)) %>%
group_by(round_x, round_y) %>%
mutate(avg_rain = mean(rain, na.rm = TRUE)) %>%
ungroup() %>%
select(round_x, round_y, avg_rain)
ca_rain_df_2_rounded <- ca_rain_df_2 %>%
mutate(round_x = round_any(x, 0.2),
round_y = round_any(y, 0.2)) %>%
group_by(round_x, round_y) %>%
mutate(avg_rain = mean(rain, na.rm = TRUE)) %>%
ungroup() %>%
select(round_x, round_y, avg_rain)
round_any = function(x, accuracy, f=round){f(x/ accuracy) * accuracy}
ca_rain_df_1_rounded <- ca_rain_df_2 %>%
mutate(round_x = round_any(x, 0.2),
round_y = round_any(y, 0.2)) %>%
group_by(round_x, round_y) %>%
mutate(avg_rain = mean(rain, na.rm = TRUE)) %>%
ungroup() %>%
select(round_x, round_y, avg_rain) |>
distinct()
ca_rain_df_2_rounded <- ca_rain_df_2 %>%
mutate(round_x = round_any(x, 0.2),
round_y = round_any(y, 0.2)) %>%
group_by(round_x, round_y) %>%
mutate(avg_rain = mean(rain, na.rm = TRUE)) %>%
ungroup() %>%
select(round_x, round_y, avg_rain) |>
distinct()
View(ca_rain_df_1_rounded)
View(ca_rain_df_2_rounded)
combined_df <- ca_rain_df_1_rounded |>
left_join(ca_rain_df_2_rounded, by = c("x", "y"))
View(ca_rain_df_2)
View(ca_rain_df_1_rounded)
combined_df <- ca_rain_df_1_rounded |>
left_join(ca_rain_df_2_rounded, by = c("round_x", "round_y"))
View(combined_df)
round_any = function(x, accuracy, f=round){f(x/ accuracy) * accuracy}
ca_rain_df_1_rounded <- ca_rain_df_1 %>%
mutate(round_x = round_any(x, 0.2),
round_y = round_any(y, 0.2)) %>%
group_by(round_x, round_y) %>%
mutate(avg_rain = mean(rain, na.rm = TRUE)) %>%
ungroup() %>%
select(round_x, round_y, avg_rain) |>
distinct()
ca_rain_df_2_rounded <- ca_rain_df_2 %>%
mutate(round_x = round_any(x, 0.2),
round_y = round_any(y, 0.2)) %>%
group_by(round_x, round_y) %>%
mutate(avg_rain = mean(rain, na.rm = TRUE)) %>%
ungroup() %>%
select(round_x, round_y, avg_rain) |>
distinct()
combined_df <- ca_rain_df_1_rounded |>
left_join(ca_rain_df_2_rounded, by = c("round_x", "round_y"))
View(combined_df)
combined_df <- ca_rain_df_1_rounded |>
left_join(ca_rain_df_2_rounded, by = c("round_x", "round_y")) |>
filter(!is.na(rain.y))
combined_df <- ca_rain_df_1_rounded |>
left_join(ca_rain_df_2_rounded, by = c("round_x", "round_y")) |>
filter(!is.na(avg_rain.y))
combined_df <- combined_df |>
mutate(pct_change = 100* (avg_rain.y - avg_rain.x) / avg_rain.x)
summary(combined_df$pct_change)
main_plot <- combined_df %>%
ggplot() +
geom_point(aes(x = round_x, y = round_y,
color = pct_change,
size = pct_change)) +
scale_color_gradient(name = "pct_change",
low = "red", high = "blue") +
# scale_size(range = c(0,3)) +
guides(size = "none") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.position = c(0.7, 0.8),
# legend.title = element_blank(),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle = element_text(color = "red", hjust = 0.5, size = 15),
plot.title = element_text(color = "blue", hjust = 0.5, size = 20)) +
labs(title = "Average Rainfall in California (1981 to 2010)",
subtitle = "30 Day Map Challenge, Day 27: Heatmap",
caption = "Data Source: UC Berkeley Library Geodata",
x = "", y = "")
main_plot
main_plot <- combined_df |>
filter(avg_rain.x < 5) |>
ggplot() +
geom_point(aes(x = round_x, y = round_y,
color = pct_change,
size = pct_change)) +
scale_color_gradient(name = "pct_change",
low = "red", high = "blue") +
# scale_size(range = c(0,3)) +
guides(size = "none") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.position = c(0.7, 0.8),
# legend.title = element_blank(),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle = element_text(color = "red", hjust = 0.5, size = 15),
plot.title = element_text(color = "blue", hjust = 0.5, size = 20)) +
labs(title = "Average Rainfall in California",
subtitle = "30 Day Map Challenge, Day 7: Raster",
caption = "Data Source: UC Berkeley Library Geodata",
x = "", y = "")
main_plot
main_plot <- combined_df |>
filter(avg_rain.x > 5) |>
ggplot() +
geom_point(aes(x = round_x, y = round_y,
color = pct_change,
size = pct_change)) +
scale_color_gradient(name = "pct_change",
low = "red", high = "blue") +
# scale_size(range = c(0,3)) +
guides(size = "none") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.position = c(0.7, 0.8),
# legend.title = element_blank(),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle = element_text(color = "red", hjust = 0.5, size = 15),
plot.title = element_text(color = "blue", hjust = 0.5, size = 20)) +
labs(title = "Average Rainfall in California",
subtitle = "30 Day Map Challenge, Day 7: Raster",
caption = "Data Source: UC Berkeley Library Geodata",
x = "", y = "")
main_plot
main_plot <- combined_df |>
filter(avg_rain.x > 5) |>
ggplot() +
geom_point(aes(x = round_x, y = round_y,
color = pct_change,
size = pct_change)) +
scale_color_gradient(name = "percent change",
low = "red", high = "blue") +
# scale_size(range = c(0,3)) +
guides(size = "none") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.position = c(0.7, 0.8),
# legend.title = element_blank(),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle = element_text(color = "red", hjust = 0.5, size = 15),
plot.title = element_text(color = "blue", hjust = 0.5, size = 20)) +
main_plot <- combined_df |>
filter(avg_rain.x > 5) |>
ggplot() +
geom_point(aes(x = round_x, y = round_y,
color = pct_change,
size = pct_change)) +
scale_color_gradient(name = "percent change",
low = "red", high = "blue") +
# scale_size(range = c(0,3)) +
guides(size = "none") +
labs(title = "Average Rainfall in California",
subtitle = "30 Day Map Challenge, Day 7: Raster",
caption = "Data Source: UC Berkeley Library Geodata\nFile 1: Average Rainfall (1961 to 1900)\nFile 2: Average Rainfall (1971 to 2000)\nMap made by Derek Sollberger",
x = "", y = "")
main_plot <- combined_df |>
filter(avg_rain.x > 5) |>
ggplot() +
geom_point(aes(x = round_x, y = round_y,
color = pct_change,
size = pct_change)) +
scale_color_gradient(name = "percent change",
low = "red", high = "blue") +
# scale_size(range = c(0,3)) +
guides(size = "none") +
labs(title = "Average Rainfall in California",
subtitle = "30 Day Map Challenge, Day 7: Raster",
caption = "Data Source: UC Berkeley Library Geodata\nFile 1: Average Rainfall (1961 to 1900)\nFile 2: Average Rainfall (1971 to 2000)\nMap made by Derek Sollberger",
x = "", y = "") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.position = c(0.7, 0.8),
# legend.title = element_blank(),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(color = "blue", face = "bold",
hjust = 0.5,
size = 20),
plot.subtitle = element_text(color = "red", hjust = 0.5,
size = 15),
plot.caption = element_text(color = "black", hjust = 0.0,
size = 10))
main_plot
main_plot <- combined_df |>
filter(avg_rain.x > 5) |>
ggplot() +
geom_point(aes(x = round_x, y = round_y,
color = pct_change) +
scale_color_gradient(name = "percent change",
low = "red", high = "blue") +
# scale_size(range = c(0,3)) +
guides(size = "none") +
labs(title = "Average Rainfall in California",
subtitle = "30 Day Map Challenge, Day 7: Raster",
caption = "Data Source: UC Berkeley Library Geodata\nFile 1: Average Rainfall (1961 to 1900)\nFile 2: Average Rainfall (1971 to 2000)\nMap made by Derek Sollberger",
x = "", y = "") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.position = c(0.7, 0.8),
# legend.title = element_blank(),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(color = "blue", face = "bold",
hjust = 0.5,
size = 20),
plot.subtitle = element_text(color = "red", hjust = 0.5,
size = 15),
plot.caption = element_text(color = "black", hjust = 0.0,
size = 10))
main_plot <- combined_df |>
filter(avg_rain.x > 5) |>
ggplot() +
geom_point(aes(x = round_x, y = round_y,
color = pct_change)) +
scale_color_gradient(name = "percent change",
low = "red", high = "blue") +
# scale_size(range = c(0,3)) +
guides(size = "none") +
labs(title = "Average Rainfall in California",
subtitle = "30 Day Map Challenge, Day 7: Raster",
caption = "Data Source: UC Berkeley Library Geodata\nFile 1: Average Rainfall (1961 to 1900)\nFile 2: Average Rainfall (1971 to 2000)\nMap made by Derek Sollberger",
x = "", y = "") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.position = c(0.7, 0.8),
# legend.title = element_blank(),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(color = "blue", face = "bold",
hjust = 0.5,
size = 20),
plot.subtitle = element_text(color = "red", hjust = 0.5,
size = 15),
plot.caption = element_text(color = "black", hjust = 0.0,
size = 10))
main_plot
main_plot <- combined_df |>
filter(avg_rain.x > 5) |>
ggplot() +
geom_point(aes(x = round_x, y = round_y,
color = pct_change, size = 10)) +
scale_color_gradient(name = "percent change",
low = "red", high = "blue") +
# scale_size(range = c(0,3)) +
guides(size = "none") +
labs(title = "Average Rainfall in California",
subtitle = "30 Day Map Challenge, Day 7: Raster",
caption = "Data Source: UC Berkeley Library Geodata\nFile 1: Average Rainfall (1961 to 1900)\nFile 2: Average Rainfall (1971 to 2000)\n(and then I calculated the difference in averages)\nMap made by Derek Sollberger",
x = "", y = "") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.position = c(0.7, 0.8),
# legend.title = element_blank(),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(color = "blue", face = "bold",
hjust = 0.5,
size = 20),
plot.subtitle = element_text(color = "red", hjust = 0.5,
size = 15),
plot.caption = element_text(color = "black", hjust = 0.0,
size = 10))
main_plot
main_plot <- combined_df |>
filter(avg_rain.x > 5) |>
ggplot() +
geom_point(aes(x = round_x, y = round_y,
color = pct_change, size = 10)) +
scale_color_gradient(name = "percent change",
low = "red", high = "blue") +
# scale_size(range = c(0,3)) +
guides(size = "none") +
labs(title = "Average Rainfall in California",
subtitle = "30 Day Map Challenge, Day 7: Raster",
caption = "Data Source: UC Berkeley Library Geodata\nFile 1: Average Rainfall (1961 to 1900)\nFile 2: Average Rainfall (1971 to 2000)\n(and then I calculated the difference in averages)\nMap made by Derek Sollberger",
x = "", y = "") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.key.size = unit(100, 'px'),
legend.position = c(0.7, 0.8),
legend.title = element_text(color = "blue",
size = 30),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(color = "blue", face = "bold",
hjust = 0.5,
size = 40),
plot.subtitle = element_text(color = "red",
hjust = 0.5,
size = 30),
plot.caption = element_text(color = "black",
hjust = 0.0, vjust = 20,
size = 20))
main_plot <- combined_df |>
filter(avg_rain.x > 5) |>
ggplot() +
geom_point(aes(x = round_x, y = round_y,
color = pct_change, size = 10)) +
scale_color_gradient(name = "percent change",
low = "red", high = "blue") +
# scale_size(range = c(0,3)) +
guides(size = "none") +
labs(title = "Average Rainfall in California",
subtitle = "30 Day Map Challenge, Day 7: Raster",
caption = "Data Source: UC Berkeley Library Geodata\nFile 1: Average Rainfall (1961 to 1900)\nFile 2: Average Rainfall (1971 to 2000)\n(and then I calculated the difference in averages)\nMap made by Derek Sollberger",
x = "", y = "") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.key.size = unit(3, 'cm'),
legend.position = c(0.7, 0.8),
legend.title = element_text(color = "blue",
size = 30),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(color = "blue", face = "bold",
hjust = 0.5,
size = 40),
plot.subtitle = element_text(color = "red",
hjust = 0.5,
size = 30),
plot.caption = element_text(color = "black",
hjust = 0.0, vjust = 20,
size = 20))
main_plot
main_plot <- combined_df |>
filter(avg_rain.x > 5) |>
ggplot() +
geom_point(aes(x = round_x, y = round_y,
color = pct_change, size = 10)) +
scale_color_gradient(name = "percent change",
low = "red", high = "blue") +
# scale_size(range = c(0,3)) +
guides(size = "none") +
labs(title = "Average Rainfall in California",
subtitle = "30 Day Map Challenge, Day 7: Raster",
caption = "Data Source: UC Berkeley Library Geodata\nFile 1: Average Rainfall (1961 to 1900)\nFile 2: Average Rainfall (1971 to 2000)\n(and then I calculated the difference in averages)\nMap made by Derek Sollberger",
x = "", y = "") +
theme(axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
legend.key.size = unit(2, 'cm'),
legend.position = c(0.7, 0.8),
legend.title = element_text(color = "blue",
size = 30),
panel.background = element_blank(),
panel.grid.minor = element_blank(),
plot.title = element_text(color = "blue", face = "bold",
hjust = 0.5,
size = 40),
plot.subtitle = element_text(color = "red",
hjust = 0.5,
size = 30),
plot.caption = element_text(color = "black",
hjust = 0.0, vjust = 20,
size = 20))
main_plot
